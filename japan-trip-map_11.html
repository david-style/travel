<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026æ—¥æœ¬10å¤©9å¤œè¡Œç¨‹åœ°åœ–</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
        }
        .container {
            display: flex;
            height: 100vh;
        }
        #map {
            flex: 1;
            height: 100%;
        }
        .sidebar {
            width: 360px;
            background: #16213e;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #2a2a5a;
        }
        h1 {
            font-size: 1.3rem;
            margin-bottom: 5px;
            color: #fff;
        }
        .subtitle {
            font-size: 0.85rem;
            color: #888;
        }
        .days-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }
        .day-section {
            margin-bottom: 12px;
            background: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
        }
        .day-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .day-header:hover {
            background: #252550;
        }
        .day-badge {
            background: #4ecdc4;
            color: #1a1a2e;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 700;
            min-width: 50px;
            text-align: center;
        }
        .day-info {
            flex: 1;
        }
        .day-date {
            font-size: 0.75rem;
            color: #888;
        }
        .day-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #fff;
        }
        .day-toggle {
            color: #4ecdc4;
            font-size: 1.2rem;
            transition: transform 0.3s;
        }
        .day-section.expanded .day-toggle {
            transform: rotate(180deg);
        }
        .spots-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .day-section.expanded .spots-list {
            max-height: 1500px;
        }
        .spot-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px 10px 20px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        .spot-item:hover {
            background: #252550;
            border-left-color: #4ecdc4;
        }
        .spot-item.active {
            background: #2a2a5a;
            border-left-color: #ffe66d;
        }
        .spot-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }
        .spot-icon.hotel { background: #ff6b6b; }
        .spot-icon.attraction { background: #4ecdc4; }
        .spot-icon.food { background: #ffe66d; }
        .spot-icon.transport { background: #95e1d3; }
        .spot-info {
            flex: 1;
            min-width: 0;
        }
        .spot-name {
            font-size: 0.85rem;
            font-weight: 500;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .spot-desc {
            font-size: 0.75rem;
            color: #888;
        }
        .spot-arrow {
            color: #555;
            font-size: 0.8rem;
        }
        .spot-item:hover .spot-arrow {
            color: #4ecdc4;
        }
        
        /* Detail Panel */
        .spot-detail {
            background: #232350;
            padding: 12px 12px 12px 28px;
            display: none;
            border-left: 3px solid #ffe66d;
            animation: slideDown 0.2s ease-out;
        }
        .spot-detail.show {
            display: block;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .detail-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 0.8rem;
        }
        .detail-row:last-child {
            margin-bottom: 0;
        }
        .detail-label {
            color: #888;
            min-width: 60px;
        }
        .detail-value {
            color: #fff;
        }
        .status-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        .status-booked {
            background: #2ecc71;
            color: #fff;
        }
        .status-pending {
            background: #f39c12;
            color: #fff;
        }
        .status-none {
            background: #555;
            color: #aaa;
        }
        .price-tag {
            color: #ffe66d;
            font-weight: 600;
        }
        .detail-note {
            color: #aaa;
            font-style: italic;
            font-size: 0.75rem;
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px dashed #3a3a6a;
        }

        /* Expense Summary */
        .expense-summary {
            padding: 15px 20px;
            background: #1a1a2e;
            border-top: 1px solid #2a2a5a;
        }
        .expense-summary h3 {
            font-size: 0.9rem;
            margin-bottom: 12px;
            color: #ffe66d;
        }
        .expense-person {
            margin-bottom: 12px;
            padding: 10px;
            background: #232350;
            border-radius: 8px;
        }
        .person-name {
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 8px;
            color: #fff;
        }
        .expense-items {
            font-size: 0.75rem;
            color: #aaa;
        }
        .expense-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }
        .expense-total {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #3a3a6a;
            font-size: 0.8rem;
            font-weight: 600;
            color: #4ecdc4;
            text-align: right;
        }
        .grand-total {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.95rem;
            color: #1a1a2e;
        }

        /* Legend */
        .legend {
            padding: 15px 20px;
            background: #1a1a2e;
            border-top: 1px solid #2a2a5a;
        }
        .legend h3 {
            font-size: 0.85rem;
            margin-bottom: 10px;
            color: #4ecdc4;
        }
        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.75rem;
        }
        .legend-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        .legend-color.hotel { background: #ff6b6b; }
        .legend-color.attraction { background: #4ecdc4; }
        .legend-color.food { background: #ffe66d; }
        .legend-color.transport { background: #95e1d3; }
        
        .leaflet-popup-content-wrapper {
            background: #16213e;
            color: #fff;
            border-radius: 10px;
        }
        .leaflet-popup-content {
            margin: 12px;
        }
        .leaflet-popup-tip {
            background: #16213e;
        }
        .popup-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 5px;
        }
        .popup-day {
            font-size: 0.75rem;
            color: #4ecdc4;
            margin-bottom: 5px;
        }
        .popup-desc {
            font-size: 0.85rem;
            color: #aaa;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column-reverse;
            }
            .sidebar {
                width: 100%;
                height: 45vh;
            }
            #map {
                height: 55vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="map"></div>
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>ğŸ‡¯ğŸ‡µ 2026 æ—¥æœ¬è¡Œç¨‹</h1>
                <p class="subtitle">2/26 - 3/7 ãƒ» 10å¤©9å¤œ ãƒ» é»æ“Šåœ°é»æŸ¥çœ‹è©³æƒ…</p>
            </div>
            
            <div class="days-container" id="days-container"></div>
            
            <div class="expense-summary">
                <h3>ğŸ’° å·²ä»˜æ¬¾ç¸½é¡</h3>
                <div class="expense-person">
                    <div class="person-name">ğŸ§‘ å˜é€¼</div>
                    <div class="expense-items">
                        <div class="expense-row"><span>æ©Ÿç¥¨ä¾†å›ï¼ˆE712SFï¼‰</span><span>NT$16,056</span></div>
                        <div class="expense-row"><span>è‰æ´¥æœ›é›² 2æ™š</span><span>Â¥118,800 â‰ˆ NT$26,136</span></div>
                    </div>
                    <div class="expense-total">å°è¨ˆï¼šNT$42,192</div>
                </div>
                <div class="expense-person">
                    <div class="person-name">ğŸ‘© èŠ¯ç‘œ</div>
                    <div class="expense-items">
                        <div class="expense-row"><span>æ©Ÿç¥¨ä¾†å›ï¼ˆICC4QTï¼‰</span><span>NT$20,602</span></div>
                        <div class="expense-row"><span>APA Hotel 4æ™š</span><span>Â¥68,200 â‰ˆ NT$15,004</span></div>
                        <div class="expense-row"><span>OMO5 äº”åç”° 3æ™š</span><span>Â¥72,600 â‰ˆ NT$15,972</span></div>
                    </div>
                    <div class="expense-total">å°è¨ˆï¼šNT$51,578</div>
                </div>
                <div class="grand-total">
                    <span>å…©äººåˆè¨ˆ</span>
                    <span>NT$93,770</span>
                </div>
            </div>
            
            <div class="legend">
                <h3>ğŸ“ åœ–ä¾‹</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-color hotel"></div>
                        <span>ä½å®¿</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color attraction"></div>
                        <span>æ™¯é»</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color food"></div>
                        <span>é¤å»³</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color transport"></div>
                        <span>äº¤é€š</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize map
        const map = L.map('map').setView([35.7, 139.5], 10);
        
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // All itinerary data with detailed info
        const itinerary = [
            {
                day: 1,
                date: "2/26 å››",
                title: "æŠµé”ãƒ»ä¸Šé‡",
                spots: [
                    { 
                        name: "æˆç”°æ©Ÿå ´", 
                        lat: 35.7720, lng: 140.3929, 
                        type: "transport", 
                        desc: "12:30 æŠµé”", 
                        icon: "âœˆï¸",
                        details: {
                            time: "12:30 æŠµé”",
                            booking: "booked",
                            bookingNote: "AirAsia FD234ï½œå·²é ç´„ âœ“",
                            bookedBy: "å„è‡ªé è¨‚",
                            bookingNumber: "å˜é€¼ E712SF ï¼ èŠ¯ç‘œ ICC4QT",
                            price: "å˜é€¼ NT$16,056 ï¼ èŠ¯ç‘œ NT$20,602",
                            priceNTD: "å…©äººåˆè¨ˆ NT$36,658",
                            paidBy: "å„è‡ªä»˜æ¬¾",
                            paymentStatus: "âœ… çš†å·²ä»˜",
                            note: "08:05å°æ¸¯å‡ºç™¼ï½œå˜é€¼åº§ä½1A èŠ¯ç‘œåº§ä½1Bï½œæ©Ÿä¸Šé¤ï¼šç„—çƒ¤é›™èµ·å¸é€šå¿ƒç²‰ï¼ç¾©å¤§åˆ©é›è‚‰åƒå±¤éºµ"
                        }
                    },
                    { 
                        name: "APA Hotel ä¸Šé‡ç«™å‰", 
                        lat: 35.7138, lng: 139.7774, 
                        type: "hotel", 
                        desc: "ğŸ¨ ä½å®¿ 4æ™š", 
                        icon: "ğŸ¨",
                        details: {
                            time: "15:00 Check-in",
                            booking: "booked",
                            bookingNote: "å·²é ç´„ âœ“",
                            bookedBy: "èŠ¯ç‘œï¼ˆKUO HSINYUï¼‰",
                            bookingNumber: "250730000329",
                            price: "Â¥68,200ï¼ˆ4æ™šï¼‰",
                            priceNTD: "â‰ˆ NT$15,004",
                            paidBy: "èŠ¯ç‘œ",
                            paymentStatus: "âœ… ä¿¡ç”¨å¡å·²ä»˜ï¼ˆæ—¥å¹£ï¼‰",
                            note: "æˆ¿é–“åå°ï¼Œè€ƒæ…®æ›å…¶ä»–é£¯åº—",
                            website: "https://www.apahotel.com/hotel/shutoken/tokyo/ueno-ekimae/"
                        }
                    },
                    { 
                        name: "ä¸Šé‡æ©è³œå…¬åœ’", 
                        lat: 35.7146, lng: 139.7732, 
                        type: "attraction", 
                        desc: "æ¢…èŠ±å­£æ•£æ­¥", 
                        icon: "ğŸŒ¸",
                        details: {
                            time: "13:30-16:00",
                            booking: "none",
                            price: "å…è²»",
                            note: "2æœˆåº•æ¢…èŠ±ç››é–‹"
                        }
                    },
                    { 
                        name: "é˜¿ç¾æ©«ä¸", 
                        lat: 35.7085, lng: 139.7745, 
                        type: "attraction", 
                        desc: "è³¼ç‰©è¡—", 
                        icon: "ğŸ›ï¸",
                        details: {
                            time: "16:00-18:00",
                            booking: "none",
                            price: null,
                            note: "è—¥å¦ã€é›¶é£Ÿã€æµ·é®®"
                        }
                    },
                    { 
                        name: "æ•˜æ•˜è‹‘ ä¸Šé‡ä¸å¿å£åº—", 
                        lat: 35.7128, lng: 139.7743, 
                        type: "food", 
                        desc: "18:00 æ™šé¤", 
                        icon: "ğŸ¥©",
                        details: {
                            time: "18:00",
                            booking: "booked",
                            bookingNote: "å·²é ç´„ âœ“",
                            bookedBy: "å˜é€¼ï¼ˆlee chichiehï¼‰",
                            bookingNumber: "å®˜ç¶²ç·šä¸Šé ç´„",
                            price: "ç´„ Â¥13,500-15,000/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$2,970-3,300/äºº",
                            paymentStatus: "ç¾å ´ä»˜æ¬¾",
                            note: "æœˆä¹‹å®´å¥—é¤ï¼Œç„¡ä½æ¶ˆé™åˆ¶",
                            website: "https://www.jojoen.co.jp/"
                        }
                    }
                ]
            },
            {
                day: 2,
                date: "2/27 äº”",
                title: "æ·ºè‰ãƒ»æ™´ç©ºå¡”",
                spots: [
                    { 
                        name: "æ·ºè‰å¯ºãƒ»é›·é–€", 
                        lat: 35.7148, lng: 139.7967, 
                        type: "attraction", 
                        desc: "æ±äº¬å¿…è¨ª", 
                        icon: "â›©ï¸",
                        details: {
                            time: "10:00-12:00",
                            booking: "none",
                            price: "å…è²»",
                            note: "ä»²è¦‹ä¸–é€šé€›è¡—",
                            website: "https://www.senso-ji.jp/"
                        }
                    },
                    { 
                        name: "æ·ºè‰ä»ŠåŠ æœ¬åº—", 
                        lat: 35.7121, lng: 139.7945, 
                        type: "food", 
                        desc: "å£½å–œç‡’åˆé¤", 
                        icon: "ğŸ²",
                        details: {
                            time: "12:00",
                            booking: "pending",
                            bookingNote: "éœ€é ç´„ï¼ˆ1æœˆåº•è™•ç†ï¼‰",
                            price: "ç´„ Â¥4,400-6,000/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$968-1,320/äºº",
                            note: "åˆé–“å¥—é¤è¼ƒåˆ’ç®—",
                            website: "https://www.asakusaimahan.co.jp/"
                        }
                    },
                    { 
                        name: "éš…ç”°å…¬åœ’", 
                        lat: 35.7165, lng: 139.8015, 
                        type: "attraction", 
                        desc: "å¯èƒ½æœ‰æ—©æ«»", 
                        icon: "ğŸŒ¸",
                        details: {
                            time: "14:00-15:00",
                            booking: "none",
                            price: "å…è²»",
                            note: "çœ‹é‹æ°£ï¼Œå¯èƒ½æœ‰æ—©é–‹æ«»èŠ±"
                        }
                    },
                    { 
                        name: "æ±äº¬æ™´ç©ºå¡”", 
                        lat: 35.7101, lng: 139.8107, 
                        type: "attraction", 
                        desc: "å±•æœ›å°ãƒ»è³¼ç‰©", 
                        icon: "ğŸ—¼",
                        details: {
                            time: "15:00-19:00",
                            booking: "none",
                            price: "ç´„ Â¥2,100-3,100ï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$462-682",
                            note: "å¯ç¾å ´è²·ç¥¨æˆ–é è³¼",
                            website: "https://www.tokyo-skytree.jp/"
                        }
                    },
                    { 
                        name: "åˆ©ä¹…ç‰›èˆŒ æ™´ç©ºå¡”åº—", 
                        lat: 35.7101, lng: 139.8107, 
                        type: "food", 
                        desc: "6F æ™šé¤", 
                        icon: "ğŸ¥¢",
                        details: {
                            time: "19:00",
                            booking: "none",
                            bookingNote: "å…é ç´„",
                            price: "ç´„ Â¥2,410-3,890/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$530-856/äºº",
                            note: "æ¥µåšç‰›èˆŒå®šé£Ÿå¿…é»ï¼Œç‡Ÿæ¥­åˆ°23:00",
                            website: "https://www.rikyu-gyutan.co.jp/"
                        }
                    }
                ]
            },
            {
                day: 3,
                date: "2/28 å…­",
                title: "éŠ€åº§ãƒ»æ±äº¬è»Šç«™",
                spots: [
                    { 
                        name: "Ginza Sony Park", 
                        lat: 35.6735, lng: 139.7635, 
                        type: "attraction", 
                        desc: "2025æ–°é–‹å¹•", 
                        icon: "ğŸ®",
                        details: {
                            time: "11:00-12:30",
                            booking: "none",
                            price: "å…è²»",
                            note: "è—¤æœ¬å£¯ä»‹è¨­è¨ˆï¼ŒéŠ€åº§ç«™B9å‡ºå£ç›´é€š",
                            website: "https://www.sonypark.com/"
                        }
                    },
                    { 
                        name: "GINZA SIX", 
                        lat: 35.6696, lng: 139.7636, 
                        type: "attraction", 
                        desc: "éŠ€åº§è³¼ç‰©", 
                        icon: "ğŸ›ï¸",
                        details: {
                            time: "12:30-15:00",
                            booking: "none",
                            price: null,
                            note: "é«˜ç«¯è³¼ç‰©ä¸­å¿ƒï¼Œé ‚æ¨“æœ‰èŠ±åœ’"
                        }
                    },
                    { 
                        name: "éŠ€åº§ä¸‰è¶Š", 
                        lat: 35.6717, lng: 139.7653, 
                        type: "attraction", 
                        desc: "ç™¾è²¨å…¬å¸", 
                        icon: "ğŸ¬",
                        details: {
                            time: "ä¸‹åˆ",
                            booking: "none",
                            price: null,
                            note: "B2é£Ÿå“å€å¾ˆå²å®³"
                        }
                    },
                    { 
                        name: "æ±äº¬è»Šç«™", 
                        lat: 35.6812, lng: 139.7671, 
                        type: "transport", 
                        desc: "ä¸€ç•ªè¡—ãƒ»KITTE", 
                        icon: "ğŸš‰",
                        details: {
                            time: "15:30-18:00",
                            booking: "none",
                            price: null,
                            note: "æ±äº¬è»Šç«™ä¸€ç•ªè¡—ã€å¤§ä¸¸ç™¾è²¨"
                        }
                    },
                    { 
                        name: "æ±äº¬è»Šç«™æ‹‰éºµè¡—", 
                        lat: 35.6805, lng: 139.7680, 
                        type: "food", 
                        desc: "B1 æ™šé¤", 
                        icon: "ğŸœ",
                        details: {
                            time: "18:00",
                            booking: "none",
                            price: "ç´„ Â¥1,000-1,500/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$220-330/äºº",
                            note: "å…­å˜èˆæ²¾éºµã€æ–‘é³©æ‹‰éºµäººæ°£é«˜"
                        }
                    }
                ]
            },
            {
                day: 4,
                date: "3/1 æ—¥",
                title: "è±æ´²ãƒ»teamLab",
                spots: [
                    { 
                        name: "è±æ´²å¸‚å ´", 
                        lat: 35.6425, lng: 139.7813, 
                        type: "food", 
                        desc: "æ—©é¤ãƒ»é€±æ—¥æœ‰é–‹", 
                        icon: "ğŸŸ",
                        details: {
                            time: "09:00-10:30",
                            booking: "none",
                            price: "ç´„ Â¥2,000-4,000/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$440-880/äºº",
                            note: "å£½å¸å¤§ã€å¤§å’Œå£½å¸æ’éšŠé•·",
                            website: "https://www.toyosu-market.or.jp/"
                        }
                    },
                    { 
                        name: "teamLab Planets", 
                        lat: 35.6433, lng: 139.7875, 
                        type: "attraction", 
                        desc: "2025æ“´å¤§1.5å€", 
                        icon: "ğŸ¨",
                        details: {
                            time: "12:00-15:00",
                            booking: "pending",
                            bookingNote: "éœ€é è³¼ï¼ˆ12æœˆè™•ç†ï¼‰",
                            price: "ç´„ Â¥3,800-4,200/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$836-924/äºº",
                            note: "ç©¿çŸ­è¤²ã€èµ¤è…³åƒè§€ï¼Œæœ‰æ°´æ·±è‡³å°è…¿",
                            website: "https://www.teamlab.art/jp/e/planets/"
                        }
                    },
                    { 
                        name: "è¬è‘‰ä¿±æ¨‚éƒ¨", 
                        lat: 35.6428, lng: 139.7848, 
                        type: "attraction", 
                        desc: "æº«æ³‰è¨­æ–½", 
                        icon: "â™¨ï¸",
                        details: {
                            time: "15:00-17:30",
                            booking: "none",
                            price: "ç´„ Â¥2,900/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$638/äºº",
                            note: "å¯æ³¡æ¹¯ä¼‘æ¯ï¼Œæœ‰é¤å»³",
                            website: "https://www.manyo.co.jp/toyosu/"
                        }
                    }
                ]
            },
            {
                day: 5,
                date: "3/2 ä¸€",
                title: "ä¸Šé‡â†’è‰æ´¥æº«æ³‰",
                spots: [
                    { 
                        name: "ä¸Šé‡ç«™", 
                        lat: 35.7141, lng: 139.7774, 
                        type: "transport", 
                        desc: "11:30 JRç‰¹æ€¥è‰æ´¥è™Ÿ", 
                        icon: "ğŸšƒ",
                        details: {
                            time: "11:30",
                            booking: "pending",
                            bookingNote: "JRæ±äº¬å»£åŸŸå‘¨éŠåˆ¸ï¼ˆå¾…è³¼è²·ï¼‰",
                            price: "ç´„ Â¥10,180/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$2,240/äºº",
                            note: "3æ—¥åˆ¸ï¼Œè»Šç¨‹ç´„2.5å°æ™‚"
                        }
                    },
                    { 
                        name: "é•·é‡åŸè‰æ´¥å£ç«™", 
                        lat: 36.5547, lng: 138.6419, 
                        type: "transport", 
                        desc: "14:00 æŠµé”", 
                        icon: "ğŸš‰",
                        details: {
                            time: "14:00",
                            booking: "none",
                            price: "ç´„ Â¥710/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$156/äºº",
                            note: "è½‰JRé—œæ±å·´å£«25åˆ†é˜åˆ°è‰æ´¥"
                        }
                    },
                    { 
                        name: "è‰æ´¥æœ›é›²æ—…é¤¨", 
                        lat: 36.6230, lng: 138.5948, 
                        type: "hotel", 
                        desc: "ğŸ¨ ä½å®¿ 2æ™š", 
                        icon: "ğŸ¨",
                        details: {
                            time: "14:00 Check-in",
                            booking: "booked",
                            bookingNote: "å·²é ç´„ âœ“",
                            bookedBy: "å˜é€¼ï¼ˆæå­£æ½”ï¼‰",
                            bookingNumber: "2025091126721444",
                            price: "Â¥118,800ï¼ˆ2æ™šå«æ—©æ™šé¤ï¼‰",
                            priceNTD: "â‰ˆ NT$26,136",
                            paidBy: "å˜é€¼",
                            paymentStatus: "âœ… ä¿¡ç”¨å¡å·²ä»˜ï¼ˆæ—¥å¹£ï¼‰2025/9/11",
                            note: "é›²æ¾åºµå’Œå®¤ï¼Œå«åœ°é…’+æ¹¯ç¾äººç´…é…’ç™½é…’ç«ç‘°é…’ç‰¹å…¸",
                            website: "https://www.hotelboun.com/"
                        }
                    },
                    { 
                        name: "æ¹¯ç•‘", 
                        lat: 36.6219, lng: 138.5960, 
                        type: "attraction", 
                        desc: "è‰æ´¥æº«æ³‰ä¸­å¿ƒ", 
                        icon: "â™¨ï¸",
                        details: {
                            time: "16:00",
                            booking: "none",
                            price: "å…è²»",
                            note: "è‰æ´¥åœ°æ¨™ï¼Œå¤œé–“é»ç‡ˆå¾ˆç¾"
                        }
                    },
                    { 
                        name: "ç†±ä¹ƒæ¹¯", 
                        lat: 36.6215, lng: 138.5958, 
                        type: "attraction", 
                        desc: "æ¹¯æ‰è¡¨æ¼”", 
                        icon: "ğŸ­",
                        details: {
                            time: "16:30 æˆ– 17:00",
                            booking: "none",
                            price: "ç´„ Â¥700/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$154/äºº",
                            note: "å‚³çµ±æ¹¯æ‰è¡¨æ¼”ï¼Œç´„20åˆ†é˜"
                        }
                    }
                ]
            },
            {
                day: 6,
                date: "3/3 äºŒ",
                title: "è‰æ´¥æº«æ³‰æ•´æ—¥",
                spots: [
                    { 
                        name: "è¥¿ä¹‹æ²³åŸå…¬åœ’", 
                        lat: 36.6237, lng: 138.5905, 
                        type: "attraction", 
                        desc: "æº«æ³‰å·æ•£æ­¥", 
                        icon: "ğŸŒ²",
                        details: {
                            time: "10:00-11:00",
                            booking: "none",
                            price: "å…è²»",
                            note: "æ²³åºŠå†’å‡ºæº«æ³‰ï¼Œå†¬å¤©æœ‰é›ªæ™¯"
                        }
                    },
                    { 
                        name: "è¥¿ä¹‹æ²³åŸéœ²å¤©é¢¨å‘‚", 
                        lat: 36.6245, lng: 138.5895, 
                        type: "attraction", 
                        desc: "è¶…å¤§éœ²å¤©é¢¨å‘‚", 
                        icon: "â™¨ï¸",
                        details: {
                            time: "11:00-12:00",
                            booking: "none",
                            price: "ç´„ Â¥600/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$132/äºº",
                            note: "500ã¡è¶…å¤§éœ²å¤©ï¼Œç”·å¥³åˆ†é–‹"
                        }
                    },
                    { 
                        name: "å¤§ç€§ä¹ƒæ¹¯", 
                        lat: 36.6195, lng: 138.5942, 
                        type: "attraction", 
                        desc: "å…¬å…±æµ´å ´", 
                        icon: "â™¨ï¸",
                        details: {
                            time: "15:00",
                            booking: "none",
                            price: "ç´„ Â¥980/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$216/äºº",
                            note: "æœ‰åˆæ¹¯ï¼ˆæ¼¸é€²å¼æ³¡æ¹¯ï¼‰é«”é©—"
                        }
                    },
                    { 
                        name: "å¾¡åº§ä¹‹æ¹¯", 
                        lat: 36.6217, lng: 138.5955, 
                        type: "attraction", 
                        desc: "å…¬å…±æµ´å ´", 
                        icon: "â™¨ï¸",
                        details: {
                            time: "ä¸‹åˆ",
                            booking: "none",
                            price: "ç´„ Â¥700/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$154/äºº",
                            note: "æ¹¯ç•‘æ—ï¼Œæ±Ÿæˆ¶é¢¨å»ºç¯‰"
                        }
                    }
                ]
            },
            {
                day: 7,
                date: "3/4 ä¸‰",
                title: "è¼•äº•æ¾¤â†’æ±äº¬",
                spots: [
                    { 
                        name: "è‰æ´¥å·´å£«ç¸½ç«™", 
                        lat: 36.6213, lng: 138.5963, 
                        type: "transport", 
                        desc: "10:30 è‰è¼•å·´å£«", 
                        icon: "ğŸšŒ",
                        details: {
                            time: "10:30",
                            booking: "none",
                            price: "ç´„ Â¥2,240/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$493/äºº",
                            note: "è»Šç¨‹ç´„80åˆ†é˜åˆ°è¼•äº•æ¾¤"
                        }
                    },
                    { 
                        name: "è¼•äº•æ¾¤ç‹å­è³¼ç‰©å»£å ´", 
                        lat: 36.3411, lng: 138.6350, 
                        type: "attraction", 
                        desc: "Outlet 240+åº—", 
                        icon: "ğŸ›ï¸",
                        details: {
                            time: "12:00-16:00",
                            booking: "none",
                            price: null,
                            note: "TNFã€GUCCIã€COACHç­‰ï¼Œå—å£æ­¥è¡Œ3åˆ†",
                            website: "https://www.karuizawa-psp.jp/"
                        }
                    },
                    { 
                        name: "è¼•äº•æ¾¤ç«™", 
                        lat: 36.3447, lng: 138.6358, 
                        type: "transport", 
                        desc: "16:30 åŒ—é™¸æ–°å¹¹ç·š", 
                        icon: "ğŸš„",
                        details: {
                            time: "16:30",
                            booking: "none",
                            bookingNote: "JRæ±äº¬å»£åŸŸå‘¨éŠåˆ¸å¯ç”¨",
                            price: "å‘¨éŠåˆ¸å«",
                            note: "è»Šç¨‹ç´„70åˆ†é˜åˆ°æ±äº¬"
                        }
                    },
                    { 
                        name: "OMO5 äº”åç”°", 
                        lat: 35.6261, lng: 139.7234, 
                        type: "hotel", 
                        desc: "ğŸ¨ ä½å®¿ 3æ™š", 
                        icon: "ğŸ¨",
                        details: {
                            time: "15:00 Check-in",
                            booking: "booked",
                            bookingNote: "å·²é ç´„ âœ“",
                            bookedBy: "èŠ¯ç‘œï¼ˆKUO HSINYUï¼‰",
                            bookingNumber: "ï¼ˆæ˜Ÿé‡å®˜ç¶²é ç´„ï¼‰",
                            price: "Â¥72,600ï¼ˆ3æ™šï¼‰",
                            priceNTD: "â‰ˆ NT$15,972",
                            paidBy: "èŠ¯ç‘œ",
                            paymentStatus: "âœ… ä¿¡ç”¨å¡å·²ä»˜ï¼ˆæ—¥å¹£ï¼‰",
                            note: "æ˜Ÿé‡é›†åœ˜ï¼Œ2äººç‰¹å¤§è™ŸåºŠï¼Œè¿‘ç›®é»‘å·ï¼Œå¯ç²2,975é»",
                            website: "https://hoshinoresorts.com/ja/hotels/omo5tokyogotanda/"
                        }
                    }
                ]
            },
            {
                day: 8,
                date: "3/5 å››",
                title: "âš¾ WBC å°ç£vsæ¾³æ´²",
                spots: [
                    { 
                        name: "æ±äº¬å·¨è›‹", 
                        lat: 35.7056, lng: 139.7519, 
                        type: "attraction", 
                        desc: "âš¾ 11:00 å°ç£vsæ¾³æ´²", 
                        icon: "âš¾",
                        details: {
                            time: "11:00 é–‹è³½",
                            booking: "pending",
                            bookingNote: "1/15 18:00 æ¶ç¥¨",
                            price: "ç´„ Â¥3,000èµ·/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$660èµ·/äºº",
                            note: "æŒ‡å®šå¸­Bï½œLawson Ticketè³¼ç¥¨ï½œä¸‰å£˜å´A38-41ç‚ºå°ç£æ‡‰æ´å¸­",
                            website: "https://www.tokyo-dome.co.jp/"
                        }
                    },
                    { 
                        name: "æ°´é“æ©‹ç«™", 
                        lat: 35.7025, lng: 139.7538, 
                        type: "transport", 
                        desc: "JRä¸­å¤®ç·š", 
                        icon: "ğŸš‰",
                        details: {
                            time: null,
                            booking: "none",
                            price: null,
                            note: "å¾äº”åç”°ç´„25åˆ†é˜"
                        }
                    },
                    { 
                        name: "Shibuya Sky", 
                        lat: 35.6584, lng: 139.7022, 
                        type: "attraction", 
                        desc: "å±•æœ›å°ãƒ»æ—¥è½17:30", 
                        icon: "ğŸŒ†",
                        details: {
                            time: "16:00-18:30",
                            booking: "pending",
                            bookingNote: "å»ºè­°é è³¼",
                            price: "ç´„ Â¥2,200/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$484/äºº",
                            note: "æ¾€è°·ç«™ç›´çµï¼Œ360åº¦éœ²å¤©å±•æœ›",
                            website: "https://www.shibuya-scramble-square.com/sky/"
                        }
                    },
                    { 
                        name: "æ¾€è°·", 
                        lat: 35.6580, lng: 139.7016, 
                        type: "attraction", 
                        desc: "æ™šé¤ãƒ»é€›è¡—", 
                        icon: "ğŸ›ï¸",
                        details: {
                            time: "18:30-21:00",
                            booking: "none",
                            price: null,
                            note: "109ã€PARCOã€å¿ çŠ¬å…«å…¬åƒ"
                        }
                    }
                ]
            },
            {
                day: 9,
                date: "3/6 äº”",
                title: "âš¾ WBC å°æ—¥å¤§æˆ°",
                spots: [
                    { 
                        name: "Artizon Museum", 
                        lat: 35.6776, lng: 139.7707, 
                        type: "attraction", 
                        desc: "ç¾è¡“é¤¨", 
                        icon: "ğŸ–¼ï¸",
                        details: {
                            time: "10:00-12:30",
                            booking: "pending",
                            bookingNote: "éœ€ç¶²è·¯é ç´„ï¼ˆ12æœˆè™•ç†ï¼‰",
                            price: "ç´„ Â¥1,800/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$396/äºº",
                            note: "å±•è¦½ï¼šSophie Taeuber-Arp & Jean Arp",
                            website: "https://www.artizon.museum/"
                        }
                    },
                    { 
                        name: "æ±äº¬è»Šç«™å‘¨é‚Š", 
                        lat: 35.6812, lng: 139.7671, 
                        type: "food", 
                        desc: "åˆé¤", 
                        icon: "ğŸ½ï¸",
                        details: {
                            time: "12:30-14:00",
                            booking: "none",
                            price: null,
                            note: "å…«é‡æ´²å£æ­¥è¡Œ5åˆ†é˜åˆ°ç¾è¡“é¤¨"
                        }
                    },
                    { 
                        name: "æ±äº¬å·¨è›‹", 
                        lat: 35.7056, lng: 139.7519, 
                        type: "attraction", 
                        desc: "âš¾ 18:00 å°ç£vsæ—¥æœ¬ ğŸ”¥", 
                        icon: "âš¾",
                        details: {
                            time: "18:00 é–‹è³½",
                            booking: "pending",
                            bookingNote: "1/15 18:00 æ¶ç¥¨ï¼ˆæœ€æ¶æ‰‹ï¼ï¼‰",
                            price: "ç´„ Â¥6,500èµ·/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$1,430èµ·/äºº",
                            note: "æŒ‡å®šå¸­Cï½œğŸ”¥å¤§è°·ç¿”å¹³ç¢ºå®šåƒè³½ï¼æ—¥æœ¬éšŠå ´æ¬¡æœ€è²´",
                            website: "https://www.tokyo-dome.co.jp/"
                        }
                    }
                ]
            },
            {
                day: 10,
                date: "3/7 å…­",
                title: "è¿”ç¨‹",
                spots: [
                    { 
                        name: "äº”åç”°ç«™", 
                        lat: 35.6261, lng: 139.7234, 
                        type: "transport", 
                        desc: "09:00 JRå±±æ‰‹ç·š", 
                        icon: "ğŸšƒ",
                        details: {
                            time: "09:00",
                            booking: "none",
                            price: null,
                            note: "åˆ°å“å·ç´„5åˆ†é˜"
                        }
                    },
                    { 
                        name: "å“å·ç«™", 
                        lat: 35.6284, lng: 139.7387, 
                        type: "transport", 
                        desc: "09:15 N'EXæˆç”°ç‰¹å¿«", 
                        icon: "ğŸš„",
                        details: {
                            time: "09:15",
                            booking: "none",
                            price: "ç´„ Â¥3,250/äººï¼ˆé ä¼°ï¼‰",
                            priceNTD: "â‰ˆ NT$715/äºº",
                            note: "è»Šç¨‹ç´„70åˆ†é˜åˆ°æˆç”°"
                        }
                    },
                    { 
                        name: "æˆç”°æ©Ÿå ´", 
                        lat: 35.7720, lng: 140.3929, 
                        type: "transport", 
                        desc: "13:30 èµ·é£›è¿”å°", 
                        icon: "âœˆï¸",
                        details: {
                            time: "13:30 èµ·é£›",
                            booking: "booked",
                            bookingNote: "AirAsia FD235ï½œå·²é ç´„ âœ“",
                            bookedBy: "å„è‡ªé è¨‚",
                            bookingNumber: "å˜é€¼ E712SF ï¼ èŠ¯ç‘œ ICC4QT",
                            price: "ï¼ˆå«åœ¨ä¾†å›ç¥¨ï¼‰",
                            priceNTD: null,
                            paidBy: "å„è‡ªä»˜æ¬¾",
                            paymentStatus: "âœ… çš†å·²ä»˜",
                            note: "16:55æŠµé”å°æ¸¯ï½œå˜é€¼åº§ä½1F èŠ¯ç‘œåº§ä½1Eï½œè¨—é‹å„20kg"
                        }
                    }
                ]
            }
        ];

        // Color mapping
        const colors = {
            hotel: '#ff6b6b',
            attraction: '#4ecdc4',
            food: '#ffe66d',
            transport: '#95e1d3'
        };

        // Store markers and state
        const markers = {};
        let activeSpotEl = null;
        let activeDetailEl = null;

        // Create custom icon
        function createIcon(color, emoji = '') {
            return L.divIcon({
                className: 'custom-div-icon',
                html: `<div style="
                    background: ${color};
                    width: 28px;
                    height: 28px;
                    border-radius: 50%;
                    border: 2px solid white;
                    box-shadow: 0 3px 6px rgba(0,0,0,0.4);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                ">${emoji}</div>`,
                iconSize: [28, 28],
                iconAnchor: [14, 14]
            });
        }

        // Generate booking status badge
        function getBookingBadge(status, note) {
            if (status === 'booked') {
                return `<span class="status-badge status-booked">å·²é ç´„</span> ${note || ''}`;
            } else if (status === 'pending') {
                return `<span class="status-badge status-pending">å¾…è™•ç†</span> ${note || ''}`;
            }
            return `<span class="status-badge status-none">å…é ç´„</span>`;
        }

        // Generate detail panel HTML
        function createDetailPanel(spot) {
            const d = spot.details;
            let html = '<div class="spot-detail">';
            
            if (d.time) {
                html += `<div class="detail-row">
                    <span class="detail-label">â° æ™‚é–“</span>
                    <span class="detail-value">${d.time}</span>
                </div>`;
            }
            
            html += `<div class="detail-row">
                <span class="detail-label">ğŸ“‹ é ç´„</span>
                <span class="detail-value">${getBookingBadge(d.booking, d.bookingNote)}</span>
            </div>`;
            
            if (d.bookedBy) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ‘¤ é ç´„äºº</span>
                    <span class="detail-value"><strong style="color:#4ecdc4;">${d.bookedBy}</strong></span>
                </div>`;
            }
            
            if (d.bookingNumber) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ”– é ç´„è™Ÿ</span>
                    <span class="detail-value" style="font-family:monospace;color:#ffe66d;">${d.bookingNumber}</span>
                </div>`;
            }
            
            if (d.price) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ’° è²»ç”¨</span>
                    <span class="detail-value"><span class="price-tag">${d.price}</span></span>
                </div>`;
                if (d.priceNTD) {
                    html += `<div class="detail-row">
                        <span class="detail-label"></span>
                        <span class="detail-value" style="color:#aaa;font-size:0.75rem;">${d.priceNTD}</span>
                    </div>`;
                }
            }
            
            if (d.paidBy) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ’³ ä»˜æ¬¾äºº</span>
                    <span class="detail-value"><strong style="color:#ff6b6b;">${d.paidBy}</strong></span>
                </div>`;
            }
            
            if (d.paymentStatus) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ“Œ ç‹€æ…‹</span>
                    <span class="detail-value">${d.paymentStatus}</span>
                </div>`;
            }
            
            if (d.website) {
                html += `<div class="detail-row">
                    <span class="detail-label">ğŸ”— å®˜ç¶²</span>
                    <span class="detail-value"><a href="${d.website}" target="_blank" style="color:#4ecdc4;text-decoration:none;">é»æ­¤é–‹å•Ÿ â†—</a></span>
                </div>`;
            }
            
            if (d.note) {
                html += `<div class="detail-note">ğŸ“ ${d.note}</div>`;
            }
            
            html += '</div>';
            return html;
        }

        // Generate sidebar and markers
        const container = document.getElementById('days-container');
        
        itinerary.forEach(dayData => {
            const daySection = document.createElement('div');
            daySection.className = 'day-section';
            
            // Day header
            const header = document.createElement('div');
            header.className = 'day-header';
            header.innerHTML = `
                <span class="day-badge">Day ${dayData.day}</span>
                <div class="day-info">
                    <div class="day-date">${dayData.date}</div>
                    <div class="day-title">${dayData.title}</div>
                </div>
                <span class="day-toggle">â–¼</span>
            `;
            
            header.addEventListener('click', () => {
                daySection.classList.toggle('expanded');
            });
            
            // Spots list
            const spotsList = document.createElement('div');
            spotsList.className = 'spots-list';
            
            dayData.spots.forEach((spot, idx) => {
                // Create marker
                const markerId = `day${dayData.day}-${idx}`;
                const marker = L.marker([spot.lat, spot.lng], { 
                    icon: createIcon(colors[spot.type], spot.icon) 
                }).bindPopup(`
                    <div class="popup-day">Day ${dayData.day} - ${dayData.date}</div>
                    <div class="popup-title">${spot.name}</div>
                    <div class="popup-desc">${spot.desc}</div>
                `);
                marker.addTo(map);
                markers[markerId] = marker;
                
                // Create spot container
                const spotContainer = document.createElement('div');
                
                // Create spot item
                const spotItem = document.createElement('div');
                spotItem.className = 'spot-item';
                spotItem.innerHTML = `
                    <div class="spot-icon ${spot.type}">${spot.icon}</div>
                    <div class="spot-info">
                        <div class="spot-name">${spot.name}</div>
                        <div class="spot-desc">${spot.desc}</div>
                    </div>
                    <span class="spot-arrow">â–¼</span>
                `;
                
                // Create detail panel
                const detailPanel = document.createElement('div');
                detailPanel.innerHTML = createDetailPanel(spot);
                const detailEl = detailPanel.firstChild;
                
                // Click handler
                spotItem.addEventListener('click', (e) => {
                    e.stopPropagation();
                    
                    // Toggle detail panel
                    if (activeDetailEl && activeDetailEl !== detailEl) {
                        activeDetailEl.classList.remove('show');
                    }
                    if (activeSpotEl && activeSpotEl !== spotItem) {
                        activeSpotEl.classList.remove('active');
                        activeSpotEl.querySelector('.spot-arrow').textContent = 'â–¼';
                    }
                    
                    const isOpen = detailEl.classList.contains('show');
                    
                    if (isOpen) {
                        detailEl.classList.remove('show');
                        spotItem.classList.remove('active');
                        spotItem.querySelector('.spot-arrow').textContent = 'â–¼';
                        activeDetailEl = null;
                        activeSpotEl = null;
                    } else {
                        detailEl.classList.add('show');
                        spotItem.classList.add('active');
                        spotItem.querySelector('.spot-arrow').textContent = 'â–²';
                        activeDetailEl = detailEl;
                        activeSpotEl = spotItem;
                        
                        // Fly to location
                        map.flyTo([spot.lat, spot.lng], 16, { duration: 0.8 });
                        setTimeout(() => markers[markerId].openPopup(), 400);
                    }
                });
                
                spotContainer.appendChild(spotItem);
                spotContainer.appendChild(detailEl);
                spotsList.appendChild(spotContainer);
            });
            
            daySection.appendChild(header);
            daySection.appendChild(spotsList);
            container.appendChild(daySection);
        });

        // Draw route
        const routePoints = [
            [35.7720, 140.3929],
            [35.7138, 139.7774],
            [35.7148, 139.7967],
            [35.6735, 139.7635],
            [35.6433, 139.7875],
            [36.6219, 138.5960],
            [36.3447, 138.6358],
            [35.6261, 139.7234],
            [35.7056, 139.7519],
            [35.6284, 139.7387],
            [35.7720, 140.3929]
        ];

        L.polyline(routePoints, {
            color: '#4ecdc4',
            weight: 2,
            opacity: 0.4,
            dashArray: '8, 8'
        }).addTo(map);

        // Expand Day 1 by default
        document.querySelector('.day-section').classList.add('expanded');

        // Fit bounds
        const allLatLngs = Object.values(markers).map(m => m.getLatLng());
        map.fitBounds(L.latLngBounds(allLatLngs), { padding: [30, 30] });
    </script>
</body>
</html>
